clf;
ft=2000;fp=400;fs=500;
wp=2*pi*fp/ft;ws=2*pi*fs/ft;
omegp=tan(wp/2);omegs=tan(ws/2);
omega=1;omegb=omegp/omegs;
[n,wn]=cheb1ord(omega, omegb, 1, 40,'s');
[b,a] = cheby1(n,1, wn, 's');
[num,den]=bilinear(b,a,0.5);
[z,p,k]=tf2zp(num,den);
[h,w]=freqz(num,den,256);
g = 20*log10(abs(h));
figure(1)
subplot(2,1,1);
plot(w/pi,g);grid on;
axis([0 1 -60 1]);
xlabel('频率，Hz'); ylabel('增益， dB');
title('切比雪夫1型低通滤波器');
subplot(2,1,2);
zplane(z,p);
xlabel('z'); ylabel('p');
title('传输零极点');
f1=300,f2=600;
n=0:600;
t=n/10000;
x1=sin(2*pi*f1*t);
x2=sin(2*pi*f2*t);
x=x1+x2;
figure(2)
subplot(2,2,1);
plot(x1);grid on;
axis([0,50*pi,-3,3]);
xlabel('t');ylabel('x1');
title('x1的波形');
subplot(2,2,2);
plot(x2);grid on;
axis([0,50*pi,-3,3]);
xlabel('t');ylabel('x2');
title('x2的波形');
subplot(2,2,3);
plot(x);grid on;
axis([0,50*pi,-3,3]);
xlabel('t');ylabel('x');
title('输入x的波形');
y=filter(num,den,x);
subplot(2,2,4)
plot(y);grid on;
axis([0,50*pi,-3,3]);
xlabel('t');ylabel('y');
title('滤波器输出y的波形');
